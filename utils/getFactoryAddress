import fs from 'fs';
import path from 'path';

export default function handler(req, res) {
  const buildPath = path.resolve(process.cwd(), 'build/contracts/CampaignFactory.json');
  const contract = JSON.parse(fs.readFileSync(buildPath, 'utf8'));

  const networkId = process.env.NEXT_PUBLIC_GANACHE_NETWORK_ID;
  const networkData = contract.networks[networkId];

  if (!networkData) {
    return res.status(404).json({ error: `Contract not deployed on network with ID ${networkId}` });
  }

  const address = networkData.address;
  res.status(200).json({ address });
}
